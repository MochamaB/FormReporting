# KTDA ICT REPORTING SYSTEM
## Reports & Dashboard Implementation Guide

**Document Version:** 1.0
**Last Updated:** 2025-10-30
**Phase:** 2.4 - Reports & Dashboards
**Duration:** Week 10 (5 days, parallel with Week 9)
**Implementation Order:** Sixth document - Read after Approval Workflow Implementation

---

## TABLE OF CONTENTS

1. [Overview](#1-overview)
2. [Dashboard UI & Mockups](#2-dashboard-ui--mockups)
3. [Report Types](#3-report-types)
4. [User Journeys](#4-user-journeys)
5. [Component Breakdown](#5-component-breakdown)
6. [Data Aggregation Logic](#6-data-aggregation-logic)
7. [Chart Visualizations](#7-chart-visualizations)
8. [Step-by-Step Implementation Guide](#8-step-by-step-implementation-guide)
9. [Export Functionality](#9-export-functionality)
10. [Performance Optimization](#10-performance-optimization)
11. [Testing Checklist](#11-testing-checklist)

---

## 1. OVERVIEW

### 1.1 Purpose

The Reports & Dashboard module provides data visualization and analytics capabilities for the KTDA ICT Reporting System. It allows stakeholders to view aggregated data, identify trends, and export reports for offline analysis.

### 1.2 Key Features

- **Executive Dashboard** - High-level overview for management (regional, head office)
- **Factory Comparison Report** - Compare metrics across multiple factories
- **Trend Analysis** - Historical data visualization with time series charts
- **Hardware Inventory Report** - Detailed hardware status across all factories
- **Software License Report** - Software installation and license compliance
- **Support Tickets Report** - Ticket statistics and common issues
- **Custom Report Builder** - Ad-hoc reporting with filters (future enhancement)
- **Export to Excel** - Download reports as XLSX for offline analysis
- **Export to PDF** - Generate printable PDF reports with charts

### 1.3 User Roles & Access

| Role | Dashboard Access | Report Access |
|------|------------------|---------------|
| **Factory ICT Officer** | Own factory only | Own factory only |
| **Regional Manager** | All factories in region | All factories in region |
| **Head Office ICT Manager** | All factories | All factories |
| **Regional Director** | All factories in region (read-only) | All factories in region |
| **System Administrator** | All factories | All factories |

### 1.4 Data Sources

All reports and dashboards aggregate data from:
- **ChecklistSubmissions** - Approved submissions only (status = "Approved")
- **ChecklistResponses** - Individual question answers
- **TenantHardware** - Hardware inventory (for validation)
- **TenantSoftware** - Software installations (for validation)
- **SupportTickets** - Support ticket history
- **FinancialExpenses** - Monthly expenses (if applicable)

### 1.5 Implementation Scope

**Week 10 Deliverables (Parallel with Week 9):**
- Executive Dashboard (Day 1-2)
- Factory Comparison Report (Day 3)
- Trend Analysis with Charts (Day 4)
- Export to Excel & PDF (Day 5)
- Performance Optimization (Day 5)

**Out of Scope (Future Enhancements):**
- Custom report builder with drag-drop fields
- Scheduled email reports (daily/weekly digests)
- Advanced analytics (predictive models, anomaly detection)
- Real-time dashboard updates via SignalR

---

## 2. DASHBOARD UI & MOCKUPS

### 2.1 Executive Dashboard (Regional Manager View)

**Route:** `/Dashboard/Index`
**Access:** Regional Managers, Head Office, Directors

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ KTDA ICT Reporting System          ğŸ‘¤ John Kamau (Regional Manager)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ  Dashboard  ğŸ“‹ Reports  âœ… Approvals  âš™ï¸ Settings  ğŸ”” (2)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ EXECUTIVE DASHBOARD - NAIROBI REGION                    October 2025  â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ Filter: [Last 3 months â–¼]  [All factories â–¼]         ğŸ”„ Refresh      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š SUBMISSIONS â”‚ ğŸ’» HARDWARE â”‚ ğŸ’¿ SOFTWARE â”‚ ğŸ« TICKETS â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ This Month  â”‚ Total       â”‚ Licenses    â”‚ Open        â”‚
â”‚    12/12    â”‚   542       â”‚   98.5%     â”‚    23       â”‚
â”‚  âœ“ 100%     â”‚ Operational â”‚  Compliant  â”‚             â”‚
â”‚             â”‚   489 (90%) â”‚             â”‚ Resolved    â”‚
â”‚ Pending     â”‚ Faulty      â”‚ Antivirus   â”‚    187      â”‚
â”‚     0       â”‚    53 (10%) â”‚   100%      â”‚ This Month  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ HARDWARE STATUS TREND (Last 6 Months)                                 â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                        â•‘
â•‘ 600 â”‚                                                                  â•‘
â•‘     â”‚         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Total Computers        â•‘
â•‘ 500 â”‚        â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—                        â•‘
â•‘     â”‚                                                                  â•‘
â•‘ 400 â”‚        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Operational         â•‘
â•‘     â”‚       â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–                          â•‘
â•‘ 300 â”‚                                                                  â•‘
â•‘     â”‚                                                                  â•‘
â•‘ 200 â”‚                                                                  â•‘
â•‘     â”‚                                                                  â•‘
â•‘ 100 â”‚ â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–² Faulty                    â•‘
â•‘   0 â”‚â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€                             â•‘
â•‘     â”‚ May â”‚ Jun â”‚ Jul â”‚ Aug â”‚ Sep â”‚ Oct                               â•‘
â•‘                                                                        â•‘
â•‘ Legend: â— Total  â–  Operational  â–² Faulty                             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ TOP 5 FACTORIES BY OPERATIONAL STATUS                                 â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                        â•‘
â•‘ 1. Kangaita Factory          [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 95% (42/44)       â•‘
â•‘ 2. Ragati Factory            [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ] 92% (46/50)       â•‘
â•‘ 3. Tetu Factory              [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  ] 90% (36/40)       â•‘
â•‘ 4. Kiganjo Factory           [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   ] 88% (35/40)       â•‘
â•‘ 5. Ndima Factory             [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    ] 85% (34/40)       â•‘
â•‘                                                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ RECENT ACTIVITY                                                        â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                        â•‘
â•‘ âœ… Kangaita Factory submitted October report          2 hours ago     â•‘
â•‘ âœ… Ragati Factory report approved by you               5 hours ago     â•‘
â•‘ âš ï¸  Ndima Factory has 3 faulty computers              1 day ago       â•‘
â•‘ ğŸ“Š Tetu Factory report shows 100% license compliance  1 day ago       â•‘
â•‘ âœ… Kiganjo Factory report approved by you              2 days ago     â•‘
â•‘                                                                        â•‘
â•‘ [View All Activity â†’]                                                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[ğŸ“Š View Detailed Reports]  [ğŸ“¥ Export Dashboard (PDF)]
```

**Key UI Elements:**
- **Summary Cards** - 4 key metrics (submissions, hardware, software, tickets)
- **Trend Chart** - Time series line chart showing hardware status over time
- **Top Factories Bar Chart** - Horizontal bar chart comparing factories
- **Recent Activity Feed** - Latest events and notifications
- **Filter Controls** - Date range and factory selection
- **Export Button** - Download dashboard as PDF

---

### 2.2 Factory Comparison Report

**Route:** `/Reports/FactoryComparison`
**Access:** Regional Managers, Head Office

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ FACTORY COMPARISON REPORT                                             â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                        â•‘
â•‘ Region: [Nairobi Region â–¼]    Period: [October 2025 â–¼]               â•‘
â•‘ Factories: [â˜‘ All] â˜‘ Kangaita â˜‘ Ragati â˜‘ Tetu â˜‘ Kiganjo â˜‘ Ndima    â•‘
â•‘                                                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HARDWARE METRICS                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚ Factory        â”‚Total â”‚ Oper â”‚Faultyâ”‚OP %  â”‚ Î” M â”‚ Status â”‚          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚
â”‚ Kangaita       â”‚  44  â”‚  42  â”‚  2   â”‚ 95%  â”‚  +2% â”‚   âœ“   â”‚          â”‚
â”‚ Ragati         â”‚  50  â”‚  46  â”‚  4   â”‚ 92%  â”‚   0% â”‚   âœ“   â”‚          â”‚
â”‚ Tetu           â”‚  40  â”‚  36  â”‚  4   â”‚ 90%  â”‚  -3% â”‚   âš ï¸   â”‚          â”‚
â”‚ Kiganjo        â”‚  40  â”‚  35  â”‚  5   â”‚ 88%  â”‚  -5% â”‚   âš ï¸   â”‚          â”‚
â”‚ Ndima          â”‚  40  â”‚  34  â”‚  6   â”‚ 85%  â”‚  -7% â”‚   âŒ   â”‚          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚
â”‚ REGION TOTAL   â”‚ 214  â”‚ 193  â”‚ 21   â”‚ 90%  â”‚  -2% â”‚        â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                        â”‚
â”‚ Legend: Oper = Operational, OP% = Operational %, Î” M = Change vs last â”‚
â”‚ month, âœ“ = Good (â‰¥90%), âš ï¸ = Warning (80-89%), âŒ = Critical (<80%)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SOFTWARE METRICS                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚ Factory        â”‚ Win  â”‚  AV  â”‚Officeâ”‚ Lic% â”‚ Status â”‚                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚
â”‚ Kangaita       â”‚  44  â”‚  44  â”‚  44  â”‚ 100% â”‚   âœ“   â”‚                 â”‚
â”‚ Ragati         â”‚  50  â”‚  50  â”‚  50  â”‚ 100% â”‚   âœ“   â”‚                 â”‚
â”‚ Tetu           â”‚  40  â”‚  40  â”‚  38  â”‚  95% â”‚   âš ï¸   â”‚                 â”‚
â”‚ Kiganjo        â”‚  40  â”‚  40  â”‚  40  â”‚ 100% â”‚   âœ“   â”‚                 â”‚
â”‚ Ndima          â”‚  40  â”‚  38  â”‚  40  â”‚  95% â”‚   âš ï¸   â”‚                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚
â”‚ REGION TOTAL   â”‚ 214  â”‚ 212  â”‚ 212  â”‚  99% â”‚   âœ“   â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                                        â”‚
â”‚ Legend: Win = Windows licenses, AV = Antivirus, Lic% = License        â”‚
â”‚ compliance percentage                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SUPPORT TICKETS METRICS                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚ Factory        â”‚ Open â”‚ Res. â”‚ Avg  â”‚ Res% â”‚ Status â”‚                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚
â”‚ Kangaita       â”‚   3  â”‚  42  â”‚ 1.5d â”‚  93% â”‚   âœ“   â”‚                 â”‚
â”‚ Ragati         â”‚   5  â”‚  38  â”‚ 2.1d â”‚  88% â”‚   âš ï¸   â”‚                 â”‚
â”‚ Tetu           â”‚   7  â”‚  35  â”‚ 3.2d â”‚  83% â”‚   âš ï¸   â”‚                 â”‚
â”‚ Kiganjo        â”‚   4  â”‚  40  â”‚ 1.8d â”‚  91% â”‚   âœ“   â”‚                 â”‚
â”‚ Ndima          â”‚   4  â”‚  32  â”‚ 2.5d â”‚  89% â”‚   âš ï¸   â”‚                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚
â”‚ REGION TOTAL   â”‚  23  â”‚ 187  â”‚ 2.2d â”‚  89% â”‚   âš ï¸   â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                                        â”‚
â”‚ Legend: Res. = Resolved, Avg = Average resolution time, Res% =        â”‚
â”‚ Resolution rate                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ OPERATIONAL STATUS COMPARISON (Chart.js Bar Chart)                    â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ 100%â”‚                                                                  â•‘
â•‘     â”‚ â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ                                        â•‘
â•‘  90%â”‚ â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ                                        â•‘
â•‘     â”‚ â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ                                        â•‘
â•‘  80%â”‚ â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ                                        â•‘
â•‘     â”‚ â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ                                        â•‘
â•‘  70%â”‚ â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ                                        â•‘
â•‘     â”‚ â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ                                        â•‘
â•‘  60%â”‚ â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆ                                        â•‘
â•‘     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                    â•‘
â•‘     â”‚ K    R    T    Ki   N                                           â•‘
â•‘                                                                        â•‘
â•‘ Green bars = Operational percentage for each factory                  â•‘
â•‘ K=Kangaita, R=Ragati, T=Tetu, Ki=Kiganjo, N=Ndima                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[ğŸ“¥ Export to Excel]  [ğŸ“„ Export to PDF]  [ğŸ“§ Email Report]
```

**Key Features:**
- **Multi-factory Selection** - Compare 2-20 factories side-by-side
- **Three Metric Categories** - Hardware, Software, Support Tickets
- **Change Indicators** - Month-over-month change percentages
- **Status Icons** - Visual indicators (âœ“, âš ï¸, âŒ) based on thresholds
- **Bar Chart Visualization** - Compare operational percentages visually
- **Export Options** - Excel, PDF, Email

---

### 2.3 Trend Analysis Report

**Route:** `/Reports/TrendAnalysis`
**Access:** All authenticated users (scoped to their authority)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ TREND ANALYSIS REPORT                                                 â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                        â•‘
â•‘ Factory: [Kangaita Factory â–¼]    Metric: [Hardware Status â–¼]         â•‘
â•‘ Period: [Jan 2025 â–¼] to [Oct 2025 â–¼]    Granularity: [Monthly â–¼]    â•‘
â•‘                                                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ HARDWARE STATUS TREND - KANGAITA FACTORY (Jan - Oct 2025)            â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                        â•‘
â•‘ 50 â”‚                                                                   â•‘
â•‘    â”‚         â—â”€â”€â”€â”€â—â”€â”€â”€â”€â—â”€â”€â”€â”€â—â”€â”€â”€â”€â—â”€â”€â”€â”€â—â”€â”€â”€â”€â—â”€â”€â”€â”€â—â”€â”€â”€â”€â—â”€â”€â”€â”€â—  Total    â•‘
â•‘ 45 â”‚        â—                                                          â•‘
â•‘    â”‚                                                                   â•‘
â•‘ 40 â”‚       â– â”€â”€â”€â”€â– â”€â”€â”€â”€â– â”€â”€â”€â”€â– â”€â”€â”€â”€â– â”€â”€â”€â”€â– â”€â”€â”€â”€â– â”€â”€â”€â”€â– â”€â”€â”€â”€â– â”€â”€â”€â”€â–   Operationalâ•‘
â•‘    â”‚      â–                                                             â•‘
â•‘ 35 â”‚                                                                   â•‘
â•‘    â”‚                                                                   â•‘
â•‘ 30 â”‚                                                                   â•‘
â•‘    â”‚                                                                   â•‘
â•‘ 25 â”‚                                                                   â•‘
â•‘    â”‚                                                                   â•‘
â•‘ 20 â”‚                                                                   â•‘
â•‘    â”‚                                                                   â•‘
â•‘ 15 â”‚                                                                   â•‘
â•‘    â”‚                                                                   â•‘
â•‘ 10 â”‚                                                                   â•‘
â•‘    â”‚                                                                   â•‘
â•‘  5 â”‚ â–²â”€â”€â”€â”€â–²â”€â”€â”€â”€â–²â”€â”€â”€â”€â–²â”€â”€â”€â”€â–²â”€â”€â”€â”€â–²â”€â”€â”€â”€â–²â”€â”€â”€â”€â–²â”€â”€â”€â”€â–²â”€â”€â”€â”€â–²  Faulty         â•‘
â•‘    â”‚â–²                                                                  â•‘
â•‘  0 â”‚â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€               â•‘
â•‘    â”‚ Jan â”‚Feb â”‚Mar â”‚Apr â”‚May â”‚Jun â”‚Jul â”‚Aug â”‚Sep â”‚Oct                â•‘
â•‘                                                                        â•‘
â•‘ Legend: â— Total (blue)  â–  Operational (green)  â–² Faulty (red)       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ KEY INSIGHTS (Auto-generated)                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                        â”‚
â”‚ âœ“ Total computers remained stable at 44 throughout the period         â”‚
â”‚ âš ï¸  Operational computers decreased from 42 (95%) to 40 (91%) in Sep  â”‚
â”‚ âš ï¸  Faulty computers increased from 2 to 4 in the last quarter        â”‚
â”‚ ğŸ“Š Operational percentage dropped below 92% threshold in Sep-Oct       â”‚
â”‚ ğŸ’¡ Recommendation: Schedule maintenance for faulty equipment           â”‚
â”‚                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MONTHLY DATA TABLE                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚ Monthâ”‚ Total â”‚ Operational  â”‚ Faulty â”‚ Retired    â”‚  OP %   â”‚         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚
â”‚ Jan  â”‚  44   â”‚     42       â”‚   2    â”‚     0      â”‚  95%    â”‚         â”‚
â”‚ Feb  â”‚  44   â”‚     42       â”‚   2    â”‚     0      â”‚  95%    â”‚         â”‚
â”‚ Mar  â”‚  44   â”‚     42       â”‚   2    â”‚     0      â”‚  95%    â”‚         â”‚
â”‚ Apr  â”‚  44   â”‚     41       â”‚   3    â”‚     0      â”‚  93%    â”‚         â”‚
â”‚ May  â”‚  44   â”‚     41       â”‚   3    â”‚     0      â”‚  93%    â”‚         â”‚
â”‚ Jun  â”‚  44   â”‚     42       â”‚   2    â”‚     0      â”‚  95%    â”‚         â”‚
â”‚ Jul  â”‚  44   â”‚     42       â”‚   2    â”‚     0      â”‚  95%    â”‚         â”‚
â”‚ Aug  â”‚  44   â”‚     41       â”‚   3    â”‚     0      â”‚  93%    â”‚         â”‚
â”‚ Sep  â”‚  44   â”‚     40       â”‚   4    â”‚     0      â”‚  91%    â”‚         â”‚
â”‚ Oct  â”‚  44   â”‚     40       â”‚   4    â”‚     0      â”‚  91%    â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                        â”‚
â”‚ Average Operational %: 94%    Trend: â–¼ Decreasing                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[ğŸ“¥ Export Chart as PNG]  [ğŸ“¥ Export Data as Excel]  [ğŸ“„ Export as PDF]
```

**Key Features:**
- **Time Series Chart** - Line chart showing metric changes over time (Chart.js)
- **Multiple Metrics** - Hardware, Software, Tickets, Network Uptime, etc.
- **Flexible Date Range** - Custom start/end dates
- **Granularity Options** - Daily, Weekly, Monthly, Quarterly
- **Auto-generated Insights** - AI-like analysis of trends (rule-based)
- **Data Table** - Raw data below chart for reference
- **Export Options** - PNG (chart only), Excel (data), PDF (full report)

---

### 2.4 Hardware Inventory Report

**Route:** `/Reports/HardwareInventory`
**Access:** All authenticated users (scoped to their authority)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ HARDWARE INVENTORY REPORT                                             â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                        â•‘
â•‘ Region: [Nairobi Region â–¼]    Factory: [All Factories â–¼]             â•‘
â•‘ Status: [All Statuses â–¼]    Item Type: [All Types â–¼]                 â•‘
â•‘                                                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SUMMARY BY STATUS                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                        â”‚
â”‚ âœ“ Operational:  193 (90%)   [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                ]   â”‚
â”‚ âš ï¸  Faulty:       21 (10%)   [â–ˆâ–ˆ                                  ]   â”‚
â”‚ ğŸ”§ Maintenance:    0 (0%)    [                                     ]   â”‚
â”‚ ğŸš« Retired:        0 (0%)    [                                     ]   â”‚
â”‚                                                                        â”‚
â”‚ TOTAL: 214 hardware items                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DETAILED INVENTORY (Showing 1-20 of 214)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ ID     â”‚ Factory     â”‚ Item Name   â”‚ Status   â”‚ Serial â”‚ Age     â”‚    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚ HW-001 â”‚ Kangaita    â”‚ Desktop PC  â”‚ âœ“ Oper.  â”‚ DL345  â”‚ 2 years â”‚    â”‚
â”‚ HW-002 â”‚ Kangaita    â”‚ Desktop PC  â”‚ âœ“ Oper.  â”‚ DL346  â”‚ 2 years â”‚    â”‚
â”‚ HW-003 â”‚ Kangaita    â”‚ Laptop      â”‚ âœ“ Oper.  â”‚ LP123  â”‚ 1 year  â”‚    â”‚
â”‚ HW-004 â”‚ Kangaita    â”‚ Desktop PC  â”‚ âš ï¸  Faultyâ”‚ DL347  â”‚ 3 years â”‚    â”‚
â”‚ HW-005 â”‚ Ragati      â”‚ Desktop PC  â”‚ âœ“ Oper.  â”‚ DL456  â”‚ 1 year  â”‚    â”‚
â”‚ HW-006 â”‚ Ragati      â”‚ Desktop PC  â”‚ âœ“ Oper.  â”‚ DL457  â”‚ 1 year  â”‚    â”‚
â”‚ HW-007 â”‚ Ragati      â”‚ Server      â”‚ âœ“ Oper.  â”‚ SV001  â”‚ 4 years â”‚    â”‚
â”‚ ...    â”‚ ...         â”‚ ...         â”‚ ...      â”‚ ...    â”‚ ...     â”‚    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                        â”‚
â”‚ [1] [2] [3] ... [11]  â†’   Showing 20 per page                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ HARDWARE BY TYPE (Chart.js Pie Chart)                                 â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                     â–„â–„â–„â–„â–„â–„â–„                                           â•‘
â•‘                 â–„â–„â–„â–„       â–€â–€â–€â–€â–„â–„â–„                                    â•‘
â•‘              â–„â–„â–„                  â–€â–€â–„                                  â•‘
â•‘            â–„â–„   Desktop PC (65%)     â–€â–„                                â•‘
â•‘          â–„â–„                            â–€                               â•‘
â•‘         â–„                               â–€                              â•‘
â•‘        â–„        Laptop (25%)             â–€                             â•‘
â•‘       â–„                                   â–€                            â•‘
â•‘       â–„   Server (5%) Printer (3%)        â–€                            â•‘
â•‘       â–€   Other (2%)                      â–„                            â•‘
â•‘        â–€â–„                               â–„â–€                             â•‘
â•‘         â–€â–„                            â–„â–€                               â•‘
â•‘           â–€â–„â–„                      â–„â–„â–€                                 â•‘
â•‘              â–€â–€â–„â–„              â–„â–„â–€â–€                                    â•‘
â•‘                  â–€â–€â–€â–„â–„â–„â–„â–„â–„â–„â–„â–€â–€â–€                                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[ğŸ“¥ Export to Excel]  [ğŸ“„ Export to PDF]  [ğŸ” Advanced Search]
```

**Key Features:**
- **Summary by Status** - Quick overview with percentage bars
- **Detailed Table** - Paginated list with all hardware details
- **Filters** - Region, factory, status, item type
- **Pie Chart** - Visual breakdown by hardware type
- **Sortable Columns** - Click column headers to sort
- **Advanced Search** - Search by serial number, item name, etc.

---

### 2.5 Software License Report

**Route:** `/Reports/SoftwareLicenses`
**Access:** Regional Managers, Head Office

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ SOFTWARE LICENSE COMPLIANCE REPORT                                    â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                        â•‘
â•‘ Region: [Nairobi Region â–¼]    Period: [October 2025 â–¼]               â•‘
â•‘                                                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ COMPLIANCE SUMMARY                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                        â”‚
â”‚ Overall Compliance: 99%  [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ         ]   â”‚
â”‚                                                                        â”‚
â”‚ âœ“ Windows Licenses:   100% compliant (214/214 computers)             â”‚
â”‚ âœ“ Antivirus:          99%  compliant (212/214 computers)             â”‚
â”‚ âœ“ Microsoft Office:   99%  compliant (212/214 computers)             â”‚
â”‚ âœ“ Other Software:     100% compliant (all licensed)                   â”‚
â”‚                                                                        â•‘
â”‚ âš ï¸  2 computers missing antivirus (Ndima Factory)                     â”‚
â”‚                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LICENSE BREAKDOWN BY FACTORY                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚ Factory     â”‚Computersâ”‚ Windows â”‚ Antivirusâ”‚ Office â”‚Compliantâ”‚      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚ Kangaita    â”‚   44   â”‚   44/44 â”‚   44/44  â”‚  44/44 â”‚   âœ“    â”‚      â”‚
â”‚ Ragati      â”‚   50   â”‚   50/50 â”‚   50/50  â”‚  50/50 â”‚   âœ“    â”‚      â”‚
â”‚ Tetu        â”‚   40   â”‚   40/40 â”‚   40/40  â”‚  38/40 â”‚   âš ï¸    â”‚      â”‚
â”‚ Kiganjo     â”‚   40   â”‚   40/40 â”‚   40/40  â”‚  40/40 â”‚   âœ“    â”‚      â”‚
â”‚ Ndima       â”‚   40   â”‚   40/40 â”‚   38/40  â”‚  40/40 â”‚   âš ï¸    â”‚      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚ TOTAL       â”‚  214   â”‚  214/214â”‚  212/214 â”‚ 212/214â”‚   99%  â”‚      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                        â”‚
â”‚ Legend: âœ“ = 100% compliant  âš ï¸ = <100% compliant                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ NON-COMPLIANT COMPUTERS (2 items)                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ ID     â”‚ Factory     â”‚ Computer    â”‚ Missing        â”‚ Action      â”‚   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚ HW-038 â”‚ Ndima       â”‚ Desktop-038 â”‚ Antivirus      â”‚ [Install]   â”‚   â”‚
â”‚ HW-039 â”‚ Ndima       â”‚ Desktop-039 â”‚ Antivirus      â”‚ [Install]   â”‚   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ LICENSE EXPIRY TIMELINE (Next 12 Months)                              â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                        â•‘
â•‘ Nov 2025: No licenses expiring                                        â•‘
â•‘ Dec 2025: 12 Windows licenses expiring (Kangaita Factory)             â•‘
â•‘ Jan 2026: No licenses expiring                                        â•‘
â•‘ Feb 2026: 50 Antivirus licenses expiring (Ragati Factory)             â•‘
â•‘ Mar 2026: 40 Office licenses expiring (Tetu Factory)                  â•‘
â•‘ ...                                                                    â•‘
â•‘                                                                        â•‘
â•‘ âš ï¸  3 factories have licenses expiring in next 3 months               â•‘
â•‘ ğŸ’¡ Recommendation: Renew licenses 1 month before expiry               â•‘
â•‘                                                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[ğŸ“¥ Export to Excel]  [ğŸ“„ Export to PDF]  [ğŸ“§ Email to Procurement]
```

**Key Features:**
- **Compliance Summary** - Overall compliance percentage with breakdown
- **Factory-level Breakdown** - License counts per factory
- **Non-compliant List** - Computers missing required software
- **License Expiry Timeline** - Upcoming expirations (proactive alerts)
- **Export Options** - Excel, PDF, Email to procurement team

---

## 3. REPORT TYPES

### 3.1 Standard Reports

| Report Name | Description | Data Source | Update Frequency |
|-------------|-------------|-------------|------------------|
| **Executive Dashboard** | High-level overview with key metrics | Approved submissions | Real-time (on page load) |
| **Factory Comparison** | Side-by-side comparison of factories | Approved submissions | Real-time |
| **Trend Analysis** | Historical data with time series charts | Approved submissions | Real-time |
| **Hardware Inventory** | Detailed hardware list with status | TenantHardware + Submissions | Real-time |
| **Software Licenses** | License compliance and expiry tracking | TenantSoftware + Submissions | Real-time |
| **Support Tickets** | Ticket statistics and common issues | SupportTickets + Submissions | Real-time |
| **Monthly Summary** | Comprehensive monthly report (PDF) | All tables | Generated on-demand |

### 3.2 Report Filters

All reports support the following filters:
- **Date Range** - Custom start/end dates or presets (Last 30 days, Last 3 months, etc.)
- **Factory Selection** - Single factory, multiple factories, or all factories
- **Region Selection** - Regional managers see only their region
- **Status Filter** - Active, Faulty, Retired (for hardware reports)
- **Metric Selection** - Choose specific metrics to display (Trend Analysis)

### 3.3 Data Freshness

- **Real-time Queries** - All reports query database on page load (no caching)
- **Caching for Performance** - Cache aggregated data for 5 minutes (configurable)
- **Background Aggregation** - Pre-compute expensive aggregates via Hangfire (future)
- **Last Updated Timestamp** - Display when data was last refreshed

---

## 4. USER JOURNEYS

### 4.1 Journey 1: Regional Manager Views Executive Dashboard

**Actors:** John Kamau (Regional Manager - Nairobi Region)

**Scenario:** John logs in Monday morning to review the status of his region.

**Steps:**

1. **John logs in** (8:00 AM)
   - Navigates to KTDA ICT Reporting System
   - Enters credentials (username + password)
   - System redirects to `/Dashboard/Index` (default landing page)

2. **Dashboard loads with Nairobi Region data**
   - System detects John's role (Regional Manager) and region (Nairobi)
   - System queries approved submissions from last 3 months for Nairobi factories
   - System calculates summary metrics:
     - Submissions: 12/12 submitted (100%)
     - Hardware: 214 total, 193 operational (90%), 21 faulty (10%)
     - Software: 99% license compliance
     - Tickets: 23 open, 187 resolved this month
   - Dashboard renders in < 2 seconds

3. **John reviews summary cards**
   - Sees 100% submission rate â†’ Good
   - Sees 90% operational hardware â†’ Acceptable but borderline
   - Sees 99% license compliance â†’ Good
   - Sees 23 open tickets â†’ Wants to investigate

4. **John examines Hardware Status Trend chart**
   - Chart shows 6-month trend (May - Oct 2025)
   - Total computers stable at ~542
   - Operational percentage declining from 92% (May) to 90% (Oct)
   - Faulty computers increasing from 43 to 53
   - **Insight:** Operational percentage trending downward

5. **John checks Top 5 Factories bar chart**
   - Kangaita: 95% operational (highest)
   - Ndima: 85% operational (lowest)
   - **Insight:** Ndima needs attention

6. **John reviews Recent Activity feed**
   - Sees "Ndima Factory has 3 faulty computers" from 1 day ago
   - Clicks "View All Activity" to see full history
   - Confirms Ndima has recurring hardware issues

7. **John decides to investigate Ndima further**
   - Clicks "View Detailed Reports" button
   - Navigates to `/Reports/FactoryComparison`
   - Applies filter: Factory = "Ndima", Period = "Last 6 months"

8. **Factory Comparison Report loads**
   - Shows Ndima's metrics declining over 6 months
   - Operational % dropped from 92% to 85%
   - Resolution time for tickets increased from 1.8d to 2.5d
   - **Insight:** Ndima needs hardware refresh or maintenance

9. **John exports report for management review**
   - Clicks "Export to PDF" button
   - System generates PDF with all charts and tables
   - PDF downloads automatically: `Factory_Comparison_Ndima_Oct2025.pdf`
   - John emails PDF to Regional Director with recommendation for hardware budget allocation

10. **John sets reminder to follow up**
    - Adds note in personal calendar: "Check Ndima hardware status next week"
    - Logs out of system

**Result:** John identified underperforming factory (Ndima) within 10 minutes of dashboard review. Generated evidence-based report for management. Proactive monitoring prevents further decline.

---

### 4.2 Journey 2: Head Office Reviews Region Performance

**Actors:** Margaret Njeri (Head Office ICT Manager)

**Scenario:** Margaret needs to prepare monthly report for executive leadership comparing all 4 regions.

**Steps:**

1. **Margaret logs in** (9:00 AM)
   - Navigates to `/Dashboard/Index`
   - System detects role (Head Office ICT Manager)
   - Dashboard shows ALL regions data by default

2. **Dashboard shows aggregated national data**
   - Total factories: 48
   - Total computers: 1,200
   - Overall operational percentage: 88%
   - **Insight:** National average below 90% target

3. **Margaret wants to compare regions**
   - Clicks "View Detailed Reports" â†’ "Factory Comparison"
   - Changes view to "Region Comparison" (special view for Head Office)
   - System shows 4 regions side-by-side:
     - Nairobi: 90% operational (214 computers)
     - Central: 88% operational (300 computers)
     - Rift Valley: 87% operational (380 computers)
     - Western: 85% operational (306 computers)

4. **Margaret identifies Western region as lowest performer**
   - Drills down: Clicks "Western" region
   - Views factory-by-factory breakdown within Western region
   - Identifies 3 factories with <80% operational status

5. **Margaret switches to Trend Analysis**
   - Navigates to `/Reports/TrendAnalysis`
   - Selects:
     - Factory: "All Factories"
     - Metric: "Operational Percentage"
     - Period: "Jan 2025 to Oct 2025"
     - Granularity: "Monthly"
     - Group by: "Region"
   - Chart shows 4 lines (one per region) over 10 months
   - **Insight:** Western region declining steadily since July

6. **Margaret reviews Software License Compliance**
   - Navigates to `/Reports/SoftwareLicenses`
   - National compliance: 97% (36 computers missing required software)
   - Filters by Region: Western
   - Western compliance: 92% (lowest)
   - **Insight:** Western region has both hardware AND software issues

7. **Margaret prepares executive report**
   - Creates new PowerPoint presentation
   - Exports Executive Dashboard as PDF â†’ Insert into slide 1
   - Exports Region Comparison chart as PNG â†’ Insert into slide 2
   - Exports Trend Analysis chart as PNG â†’ Insert into slide 3
   - Exports Software Compliance summary as Excel â†’ Convert to table in slide 4
   - Adds recommendations slide:
     - Western region needs immediate hardware refresh (budget allocation)
     - Central and Rift Valley need software license renewals (procurement)
     - Nairobi region performing well (best practices to share)

8. **Margaret emails report to CEO and CFO**
   - Subject: "Monthly ICT Status Report - October 2025"
   - Attachment: Executive_ICT_Report_Oct2025.pptx
   - Body: "Please review the attached monthly report. Western region requires urgent attention. I recommend allocating KES 2.5M for hardware refresh."

9. **Margaret schedules meeting with Western Region Manager**
   - Sends calendar invite for Friday
   - Agenda: "Discuss Western region performance and action plan"

**Result:** Margaret identified regional performance gaps within 30 minutes. Generated comprehensive executive report with evidence. Initiated corrective actions (budget allocation, regional meeting). Data-driven decision making.

---

### 4.3 Journey 3: Factory ICT Officer Views Own Performance

**Actors:** Peter Mwangi (Factory ICT Officer - Kangaita Factory)

**Scenario:** Peter wants to review his factory's performance over last 6 months to identify areas for improvement.

**Steps:**

1. **Peter logs in** (2:00 PM)
   - Navigates to `/Dashboard/Index`
   - System detects role (Factory ICT Officer) and factory (Kangaita)
   - Dashboard shows ONLY Kangaita Factory data (scoped to his authority)

2. **Dashboard shows Kangaita-specific metrics**
   - Submissions: 6/6 submitted last 6 months (100%)
   - Hardware: 44 total, 42 operational (95%)
   - Software: 100% license compliance
   - Tickets: 3 open, 42 resolved this month
   - **Insight:** Performing above average

3. **Peter reviews Hardware Status Trend**
   - Chart shows Kangaita's 6-month trend
   - Total computers stable at 44
   - Operational percentage: 95% average
   - Faulty computers: 2-3 range (normal fluctuation)
   - **Insight:** Stable performance

4. **Peter wants to compare with other factories in region**
   - Clicks "View Detailed Reports" â†’ "Factory Comparison"
   - System shows comparison with other Nairobi region factories
   - Kangaita ranks #1 in operational percentage (95%)
   - **Insight:** Best performer in region

5. **Peter checks Support Tickets report**
   - Navigates to `/Reports/SupportTickets`
   - Shows ticket breakdown:
     - Hardware issues: 15 tickets (avg resolution: 1.2 days)
     - Software issues: 20 tickets (avg resolution: 1.5 days)
     - Network issues: 10 tickets (avg resolution: 2.0 days)
   - Most common issue: "Printer not working" (8 tickets)
   - **Insight:** Printer requires attention

6. **Peter reviews License Expiry Timeline**
   - Navigates to `/Reports/SoftwareLicenses`
   - Sees 12 Windows licenses expiring in Dec 2025 (1 month away)
   - Clicks "Export to Excel" â†’ Downloads license list
   - Plans to email procurement next week for renewal

7. **Peter exports monthly report for factory manager**
   - Returns to Dashboard
   - Clicks "Export Dashboard (PDF)"
   - System generates PDF with all charts and metrics
   - PDF includes:
     - Summary metrics
     - Hardware trend chart
     - Support tickets breakdown
     - License compliance status
   - Peter emails PDF to factory manager: "Monthly ICT Status - Kangaita Factory"

**Result:** Peter confirmed his factory is performing well (95% operational, 100% compliant). Identified proactive action needed (license renewal). Provided evidence-based report to factory manager. Self-service reporting reduces ad-hoc requests.

---

## 5. COMPONENT BREAKDOWN

### 5.1 Executive Dashboard Component

**Component Name:** `ExecutiveDashboard`
**Route:** `/Dashboard/Index`
**Controller:** `DashboardController.Index()`
**View:** `Views/Dashboard/Index.cshtml`

**Sub-components:**
- **FilterPanel** - Date range, factory selection dropdowns
- **SummaryCards** - 4 metric cards (submissions, hardware, software, tickets)
- **TrendChart** - Line chart showing hardware status over time (Chart.js)
- **TopFactoriesChart** - Horizontal bar chart comparing factories (Chart.js)
- **ActivityFeed** - Recent events and notifications
- **ExportButton** - Download dashboard as PDF

**Data Requirements:**
- Approved submissions filtered by:
  - User's authority (factory, region, or all)
  - Selected date range (default: last 3 months)
- Aggregated metrics:
  - Submission count and percentage
  - Hardware totals (total, operational, faulty)
  - Software compliance percentage
  - Ticket counts (open, resolved)
- Historical data for trend chart (6-12 months)

**Calculated Fields:**
- **Submission Rate** - (Submitted count / Expected count) Ã— 100%
- **Operational Percentage** - (Operational / Total) Ã— 100%
- **License Compliance** - (Computers with all licenses / Total computers) Ã— 100%
- **Resolution Rate** - (Resolved tickets / Total tickets) Ã— 100%

**Performance Considerations:**
- Cache aggregated metrics for 5 minutes (reduce database load)
- Use indexed queries (filter by TenantId, SubmittedDate, Status)
- Limit trend chart to 12 months maximum (prevent slow queries)
- Load activity feed asynchronously (partial view + AJAX)

---

### 5.2 Factory Comparison Report Component

**Component Name:** `FactoryComparisonReport`
**Route:** `/Reports/FactoryComparison`
**Controller:** `ReportsController.FactoryComparison()`
**View:** `Views/Reports/FactoryComparison.cshtml`

**Sub-components:**
- **FilterPanel** - Region, factory multi-select, period dropdown
- **MetricTables** - 3 tables (Hardware, Software, Tickets)
- **ComparisonChart** - Bar chart comparing operational percentages (Chart.js)
- **ExportButtons** - Excel, PDF, Email

**Data Requirements:**
- List of factories to compare (2-20 factories)
- Approved submissions for selected period
- Aggregated metrics per factory:
  - Hardware: Total, Operational, Faulty, Operational %
  - Software: Windows, Antivirus, Office, License Compliance %
  - Tickets: Open, Resolved, Avg Resolution Time, Resolution %
- Change indicators (compare with previous period)

**Calculated Fields:**
- **Operational %** - (Operational / Total) Ã— 100%
- **Change vs Last Month** - Current % - Previous %
- **Status Icon** - âœ“ (â‰¥90%), âš ï¸ (80-89%), âŒ (<80%)
- **License Compliance %** - (Licensed computers / Total computers) Ã— 100%
- **Resolution %** - (Resolved / Total tickets) Ã— 100%

**Comparison Logic:**
```javascript
// Pseudo-code for change indicator calculation
function calculateChange(current, previous) {
  if (previous === null || previous === 0) {
    return { change: 0, trend: "new" };
  }

  var changePercent = ((current - previous) / previous) * 100;

  if (changePercent > 0) {
    return { change: `+${changePercent.toFixed(1)}%`, trend: "up", color: "green" };
  } else if (changePercent < 0) {
    return { change: `${changePercent.toFixed(1)}%`, trend: "down", color: "red" };
  } else {
    return { change: "0%", trend: "stable", color: "gray" };
  }
}
```

---

### 5.3 Trend Analysis Report Component

**Component Name:** `TrendAnalysisReport`
**Route:** `/Reports/TrendAnalysis`
**Controller:** `ReportsController.TrendAnalysis()`
**View:** `Views/Reports/TrendAnalysis.cshtml`

**Sub-components:**
- **FilterPanel** - Factory, metric, date range, granularity dropdowns
- **TrendChart** - Multi-line time series chart (Chart.js)
- **InsightsPanel** - Auto-generated insights based on trend analysis
- **DataTable** - Raw monthly data below chart
- **ExportButtons** - PNG (chart), Excel (data), PDF (full report)

**Supported Metrics:**
- Hardware Status (Total, Operational, Faulty)
- Software Compliance (Windows, Antivirus, Office)
- Support Tickets (Open, Resolved, Avg Resolution Time)
- Network Uptime Percentage
- License Compliance Percentage

**Granularity Options:**
- Daily (max 90 days)
- Weekly (max 1 year)
- Monthly (max 5 years)
- Quarterly (max 10 years)

**Auto-generated Insights Logic:**
```javascript
// Pseudo-code for trend insights
function generateInsights(dataPoints) {
  var insights = [];

  // Check for stability
  if (isStable(dataPoints)) {
    insights.push("âœ“ Metric remained stable throughout the period");
  }

  // Check for significant increase
  if (hasIncreased(dataPoints, threshold: 10)) {
    insights.push("âš ï¸ Metric increased significantly in last quarter");
  }

  // Check for significant decrease
  if (hasDecreased(dataPoints, threshold: 10)) {
    insights.push("âš ï¸ Metric decreased significantly in last quarter");
  }

  // Check for threshold breach
  if (breachedThreshold(dataPoints, threshold: 90)) {
    insights.push("ğŸ“Š Metric dropped below 90% threshold");
  }

  // Generate recommendation
  if (needsAttention(dataPoints)) {
    insights.push("ğŸ’¡ Recommendation: Schedule maintenance or allocate resources");
  }

  return insights;
}
```

---

### 5.4 Chart.js Integration Component

**Component Name:** `ChartRenderer`
**Implementation:** JavaScript service for rendering charts
**Library:** Chart.js 4.0

**Supported Chart Types:**
- Line Chart (trend analysis)
- Bar Chart (factory comparison)
- Horizontal Bar Chart (top factories)
- Pie Chart (hardware by type)
- Doughnut Chart (license compliance)

**Chart Configuration:**
```javascript
// Pseudo-code for Chart.js line chart
function renderTrendChart(canvasId, data, options) {
  var ctx = document.getElementById(canvasId).getContext('2d');

  var chartConfig = {
    type: 'line',
    data: {
      labels: data.months, // ['Jan', 'Feb', 'Mar', ...]
      datasets: [
        {
          label: 'Total Computers',
          data: data.total, // [44, 44, 44, ...]
          borderColor: 'rgb(54, 162, 235)', // Blue
          backgroundColor: 'rgba(54, 162, 235, 0.1)',
          tension: 0.4 // Smooth curves
        },
        {
          label: 'Operational',
          data: data.operational, // [42, 42, 41, ...]
          borderColor: 'rgb(75, 192, 192)', // Green
          backgroundColor: 'rgba(75, 192, 192, 0.1)',
          tension: 0.4
        },
        {
          label: 'Faulty',
          data: data.faulty, // [2, 2, 3, ...]
          borderColor: 'rgb(255, 99, 132)', // Red
          backgroundColor: 'rgba(255, 99, 132, 0.1)',
          tension: 0.4
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: {
          position: 'bottom'
        },
        tooltip: {
          mode: 'index',
          intersect: false
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          title: {
            display: true,
            text: 'Number of Computers'
          }
        },
        x: {
          title: {
            display: true,
            text: 'Month'
          }
        }
      }
    }
  };

  var chart = new Chart(ctx, chartConfig);
  return chart;
}
```

**Responsive Design:**
- Charts resize automatically on window resize
- Mobile: Smaller font sizes, legend below chart
- Tablet: Medium font sizes, legend on right
- Desktop: Full size, legend on right or bottom

---

## 6. DATA AGGREGATION LOGIC

### 6.1 Hardware Metrics Aggregation

**Query Pattern:**
```sql
-- Pseudo-SQL for hardware metrics aggregation
SELECT
    t.TenantId,
    t.TenantName AS FactoryName,
    COUNT(DISTINCT th.HardwareItemId) AS TotalComputers,
    SUM(CASE WHEN th.Status = 'Operational' THEN 1 ELSE 0 END) AS OperationalCount,
    SUM(CASE WHEN th.Status = 'Faulty' THEN 1 ELSE 0 END) AS FaultyCount,
    SUM(CASE WHEN th.Status = 'Under Maintenance' THEN 1 ELSE 0 END) AS MaintenanceCount,
    CAST(SUM(CASE WHEN th.Status = 'Operational' THEN 1 ELSE 0 END) AS FLOAT) /
        NULLIF(COUNT(DISTINCT th.HardwareItemId), 0) * 100 AS OperationalPercentage
FROM Tenants t
LEFT JOIN TenantHardware th ON t.TenantId = th.TenantId
WHERE t.RegionId = @RegionId -- Filter by user's region
  AND th.Status != 'Retired' -- Exclude retired equipment
GROUP BY t.TenantId, t.TenantName
ORDER BY OperationalPercentage DESC;
```

**Alternative Source (from Checklist Submissions):**
```sql
-- Query checklist responses for hardware metrics
SELECT
    cs.TenantId,
    t.TenantName AS FactoryName,
    cr1.ResponseValue AS TotalComputers,
    cr2.ResponseValue AS OperationalComputers,
    cr3.ResponseValue AS FaultyComputers,
    CAST(cr2.ResponseValue AS FLOAT) / NULLIF(cr1.ResponseValue, 0) * 100 AS OperationalPercentage
FROM ChecklistSubmissions cs
JOIN Tenants t ON cs.TenantId = t.TenantId
JOIN ChecklistResponses cr1 ON cs.SubmissionId = cr1.SubmissionId
    AND cr1.ItemCode = 'HW_TOTAL_COMPUTERS'
JOIN ChecklistResponses cr2 ON cs.SubmissionId = cr2.SubmissionId
    AND cr2.ItemCode = 'HW_OPERATIONAL'
JOIN ChecklistResponses cr3 ON cs.SubmissionId = cr3.SubmissionId
    AND cr3.ItemCode = 'HW_FAULTY'
WHERE cs.Status = 'Approved'
  AND cs.ReportingPeriod = @ReportingPeriod -- e.g., 'October 2025'
  AND t.RegionId = @RegionId
ORDER BY OperationalPercentage DESC;
```

**Data Source Priority:**
1. **Primary:** TenantHardware table (real-time inventory)
2. **Fallback:** ChecklistResponses (if inventory not available)
3. **Validation:** Compare both sources, flag discrepancies

---

### 6.2 Software License Aggregation

**Query Pattern:**
```sql
-- Pseudo-SQL for software license compliance
SELECT
    t.TenantId,
    t.TenantName AS FactoryName,
    COUNT(DISTINCT th.HardwareItemId) AS TotalComputers,
    SUM(CASE WHEN EXISTS (
        SELECT 1 FROM TenantSoftware ts
        WHERE ts.HardwareItemId = th.HardwareItemId
          AND ts.SoftwareName = 'Windows 10/11'
          AND ts.LicenseExpiryDate > GETDATE()
    ) THEN 1 ELSE 0 END) AS WindowsLicensed,
    SUM(CASE WHEN EXISTS (
        SELECT 1 FROM TenantSoftware ts
        WHERE ts.HardwareItemId = th.HardwareItemId
          AND ts.SoftwareName LIKE '%Antivirus%'
          AND ts.LicenseExpiryDate > GETDATE()
    ) THEN 1 ELSE 0 END) AS AntivirusLicensed,
    SUM(CASE WHEN EXISTS (
        SELECT 1 FROM TenantSoftware ts
        WHERE ts.HardwareItemId = th.HardwareItemId
          AND ts.SoftwareName LIKE '%Microsoft Office%'
          AND ts.LicenseExpiryDate > GETDATE()
    ) THEN 1 ELSE 0 END) AS OfficeLicensed,
    CAST(
        SUM(CASE WHEN AllLicensed.IsCompliant = 1 THEN 1 ELSE 0 END) AS FLOAT
    ) / NULLIF(COUNT(DISTINCT th.HardwareItemId), 0) * 100 AS CompliancePercentage
FROM Tenants t
JOIN TenantHardware th ON t.TenantId = th.TenantId
LEFT JOIN (
    SELECT
        HardwareItemId,
        CASE WHEN
            SUM(CASE WHEN SoftwareName = 'Windows 10/11' AND LicenseExpiryDate > GETDATE() THEN 1 ELSE 0 END) > 0 AND
            SUM(CASE WHEN SoftwareName LIKE '%Antivirus%' AND LicenseExpiryDate > GETDATE() THEN 1 ELSE 0 END) > 0 AND
            SUM(CASE WHEN SoftwareName LIKE '%Microsoft Office%' AND LicenseExpiryDate > GETDATE() THEN 1 ELSE 0 END) > 0
        THEN 1 ELSE 0 END AS IsCompliant
    FROM TenantSoftware
    GROUP BY HardwareItemId
) AllLicensed ON th.HardwareItemId = AllLicensed.HardwareItemId
WHERE th.Status = 'Operational' -- Only check operational computers
  AND t.RegionId = @RegionId
GROUP BY t.TenantId, t.TenantName
ORDER BY CompliancePercentage DESC;
```

---

### 6.3 Support Tickets Aggregation

**Query Pattern:**
```sql
-- Pseudo-SQL for support tickets metrics
SELECT
    t.TenantId,
    t.TenantName AS FactoryName,
    COUNT(CASE WHEN st.Status = 'Open' THEN 1 END) AS OpenTickets,
    COUNT(CASE WHEN st.Status = 'Resolved' AND st.ResolvedDate >= DATEADD(MONTH, -1, GETDATE()) THEN 1 END) AS ResolvedThisMonth,
    AVG(CASE WHEN st.Status = 'Resolved' THEN DATEDIFF(HOUR, st.CreatedDate, st.ResolvedDate) / 24.0 END) AS AvgResolutionDays,
    CAST(
        COUNT(CASE WHEN st.Status = 'Resolved' THEN 1 END) AS FLOAT
    ) / NULLIF(COUNT(*), 0) * 100 AS ResolutionRate
FROM Tenants t
LEFT JOIN SupportTickets st ON t.TenantId = st.TenantId
WHERE t.RegionId = @RegionId
  AND st.CreatedDate >= DATEADD(MONTH, -6, GETDATE()) -- Last 6 months
GROUP BY t.TenantId, t.TenantName
ORDER BY ResolutionRate DESC;
```

---

### 6.4 Trend Data Aggregation

**Monthly Aggregation:**
```sql
-- Pseudo-SQL for monthly trend data
SELECT
    FORMAT(cs.SubmittedDate, 'yyyy-MM') AS YearMonth,
    AVG(CAST(cr1.ResponseValue AS FLOAT)) AS AvgTotalComputers,
    AVG(CAST(cr2.ResponseValue AS FLOAT)) AS AvgOperationalComputers,
    AVG(CAST(cr3.ResponseValue AS FLOAT)) AS AvgFaultyComputers,
    AVG(CAST(cr2.ResponseValue AS FLOAT) / NULLIF(CAST(cr1.ResponseValue AS FLOAT), 0) * 100) AS AvgOperationalPercentage
FROM ChecklistSubmissions cs
JOIN ChecklistResponses cr1 ON cs.SubmissionId = cr1.SubmissionId AND cr1.ItemCode = 'HW_TOTAL_COMPUTERS'
JOIN ChecklistResponses cr2 ON cs.SubmissionId = cr2.SubmissionId AND cr2.ItemCode = 'HW_OPERATIONAL'
JOIN ChecklistResponses cr3 ON cs.SubmissionId = cr3.SubmissionId AND cr3.ItemCode = 'HW_FAULTY'
WHERE cs.Status = 'Approved'
  AND cs.TenantId = @TenantId
  AND cs.SubmittedDate >= DATEADD(MONTH, -12, GETDATE())
GROUP BY FORMAT(cs.SubmittedDate, 'yyyy-MM')
ORDER BY YearMonth ASC;
```

---

## 7. CHART VISUALIZATIONS

### 7.1 Line Chart (Trend Analysis)

**Use Case:** Display time series data (hardware status over time)

**Chart.js Configuration:**
```javascript
// Pseudo-code for line chart
var trendChartConfig = {
  type: 'line',
  data: {
    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
    datasets: [
      {
        label: 'Total',
        data: [44, 44, 44, 44, 44, 44],
        borderColor: 'rgb(54, 162, 235)',
        tension: 0.4
      },
      {
        label: 'Operational',
        data: [42, 42, 42, 41, 41, 42],
        borderColor: 'rgb(75, 192, 192)',
        tension: 0.4
      },
      {
        label: 'Faulty',
        data: [2, 2, 2, 3, 3, 2],
        borderColor: 'rgb(255, 99, 132)',
        tension: 0.4
      }
    ]
  },
  options: {
    responsive: true,
    plugins: {
      legend: { position: 'bottom' },
      tooltip: { mode: 'index' }
    },
    scales: {
      y: { beginAtZero: true }
    }
  }
};
```

**Best Practices:**
- Use smooth curves (tension: 0.4) for better visual appeal
- Limit to 3-5 data series per chart (avoid clutter)
- Use distinct colors (blue, green, red) for easy differentiation
- Display tooltip on hover with all series values
- Allow toggling series visibility (click legend)

---

### 7.2 Bar Chart (Factory Comparison)

**Use Case:** Compare metrics across multiple factories

**Chart.js Configuration:**
```javascript
// Pseudo-code for bar chart
var comparisonChartConfig = {
  type: 'bar',
  data: {
    labels: ['Kangaita', 'Ragati', 'Tetu', 'Kiganjo', 'Ndima'],
    datasets: [
      {
        label: 'Operational %',
        data: [95, 92, 90, 88, 85],
        backgroundColor: [
          'rgba(75, 192, 192, 0.8)', // Green for high
          'rgba(75, 192, 192, 0.8)',
          'rgba(255, 206, 86, 0.8)',  // Yellow for medium
          'rgba(255, 206, 86, 0.8)',
          'rgba(255, 99, 132, 0.8)'   // Red for low
        ]
      }
    ]
  },
  options: {
    responsive: true,
    plugins: {
      legend: { display: false },
      tooltip: {
        callbacks: {
          label: function(context) {
            return context.parsed.y + '% operational';
          }
        }
      }
    },
    scales: {
      y: {
        beginAtZero: true,
        max: 100,
        ticks: {
          callback: function(value) {
            return value + '%';
          }
        }
      }
    }
  }
};
```

**Color Coding:**
- **Green** - â‰¥90% (good performance)
- **Yellow** - 80-89% (warning)
- **Red** - <80% (critical)

---

### 7.3 Horizontal Bar Chart (Top Factories)

**Use Case:** Show top/bottom performers in dashboard

**Chart.js Configuration:**
```javascript
// Pseudo-code for horizontal bar chart
var topFactoriesConfig = {
  type: 'bar',
  data: {
    labels: ['Kangaita', 'Ragati', 'Tetu', 'Kiganjo', 'Ndima'],
    datasets: [{
      label: 'Operational %',
      data: [95, 92, 90, 88, 85],
      backgroundColor: 'rgba(75, 192, 192, 0.6)'
    }]
  },
  options: {
    indexAxis: 'y', // Horizontal bars
    responsive: true,
    plugins: {
      legend: { display: false }
    },
    scales: {
      x: {
        beginAtZero: true,
        max: 100
      }
    }
  }
};
```

---

### 7.4 Pie Chart (Hardware by Type)

**Use Case:** Show distribution of hardware types

**Chart.js Configuration:**
```javascript
// Pseudo-code for pie chart
var hardwareTypeConfig = {
  type: 'pie',
  data: {
    labels: ['Desktop PC', 'Laptop', 'Server', 'Printer', 'Other'],
    datasets: [{
      data: [65, 25, 5, 3, 2],
      backgroundColor: [
        'rgba(54, 162, 235, 0.8)',
        'rgba(75, 192, 192, 0.8)',
        'rgba(255, 206, 86, 0.8)',
        'rgba(255, 99, 132, 0.8)',
        'rgba(153, 102, 255, 0.8)'
      ]
    }]
  },
  options: {
    responsive: true,
    plugins: {
      legend: { position: 'right' },
      tooltip: {
        callbacks: {
          label: function(context) {
            return context.label + ': ' + context.parsed + '%';
          }
        }
      }
    }
  }
};
```

---

## 8. STEP-BY-STEP IMPLEMENTATION GUIDE

### Day 1: Executive Dashboard (Backend)

**Duration:** 8 hours
**Developer:** Senior Developer A

**Tasks:**

1. **Create DashboardController** (1 hour)
   - Create `Controllers/DashboardController.cs`
   - Add authorization (all authenticated users)
   - Add constructor with dependency injection (IReportingService)

2. **Implement Index action** (3 hours)
   - Query approved submissions filtered by user's authority
   - Calculate summary metrics (submissions, hardware, software, tickets)
   - Query historical data for trend chart (6 months)
   - Query top/bottom 5 factories
   - Query recent activity (last 10 events)
   - Return DashboardViewModel

3. **Create DashboardViewModel** (1 hour)
   - Properties:
     - SummaryMetrics (submissions, hardware, software, tickets)
     - TrendChartData (labels, datasets)
     - TopFactories (list of factory rankings)
     - RecentActivity (list of events)
     - FilterOptions (date ranges, factories)

4. **Implement ReportingService** (2 hours)
   - Create `Services/ReportingService.cs`
   - Implement methods:
     - GetSummaryMetrics(userId, dateRange)
     - GetTrendData(userId, metric, dateRange)
     - GetTopFactories(userId, limit)
     - GetRecentActivity(userId, limit)
   - Add caching (5 minutes) for performance

5. **Add unit tests** (1 hour)
   - Test: Dashboard returns correct metrics for factory user
   - Test: Dashboard returns correct metrics for regional manager
   - Test: Dashboard returns correct metrics for head office
   - Test: Date range filter works correctly

**Deliverable:** Backend API for Executive Dashboard

---

### Day 2: Executive Dashboard (Frontend)

**Duration:** 8 hours
**Developer:** Senior Developer B

**Tasks:**

1. **Create Dashboard view** (2 hours)
   - Create `Views/Dashboard/Index.cshtml`
   - Add page header with filters (date range, factory)
   - Add 4 summary cards (submissions, hardware, software, tickets)
   - Style with Bootstrap cards and AdminLTE components

2. **Implement trend chart** (2 hours)
   - Add canvas element for Chart.js
   - Write JavaScript to render line chart
   - Pass data from ViewModel to JavaScript (JSON serialization)
   - Configure chart options (colors, legend, tooltip)

3. **Implement top factories chart** (1 hour)
   - Add canvas element for horizontal bar chart
   - Render chart with color coding (green/yellow/red)
   - Display factory names and percentages

4. **Create activity feed** (1 hour)
   - Create `Views/Shared/_ActivityFeed.cshtml` partial
   - Display recent events with icons and timestamps
   - Add "View All Activity" link

5. **Implement export to PDF** (1 hour)
   - Add "Export Dashboard" button
   - Use library (e.g., SelectPdf, DinkToPdf) to generate PDF
   - Include charts as images (render to PNG first)
   - Download PDF automatically

6. **Responsive styling** (1 hour)
   - Desktop: 4-column summary cards, full-size charts
   - Tablet: 2-column summary cards, medium charts
   - Mobile: Single column, smaller charts

**Deliverable:** Fully functional Executive Dashboard UI

---

### Day 3: Factory Comparison Report

**Duration:** 8 hours
**Developer:** Senior Developer A

**Tasks:**

1. **Create FactoryComparison action** (2 hours)
   - Create `ReportsController.FactoryComparison()` action
   - Add filters: region, factories (multi-select), period
   - Query hardware metrics per factory
   - Query software metrics per factory
   - Query support tickets metrics per factory
   - Calculate change indicators (vs previous period)
   - Return FactoryComparisonViewModel

2. **Create FactoryComparisonViewModel** (1 hour)
   - Properties:
     - List<FactoryMetricsDto> Factories
     - ComparisonChartData (for bar chart)
     - FilterOptions (regions, factories, periods)

3. **Create FactoryComparisonView** (3 hours)
   - Create `Views/Reports/FactoryComparison.cshtml`
   - Add filter panel (region, factories, period)
   - Create 3 metric tables (HTML tables):
     - Hardware metrics table
     - Software metrics table
     - Support tickets table
   - Add bar chart (Chart.js) for visual comparison
   - Style with Bootstrap tables and DataTables.js (sortable, searchable)

4. **Add export functionality** (1 hour)
   - Export to Excel: Use EPPlus library to generate XLSX
   - Export to PDF: Use SelectPdf to generate PDF with tables and charts
   - Email report: Attach PDF, send via SMTP

5. **Add unit tests** (1 hour)
   - Test: Factory comparison calculates metrics correctly
   - Test: Change indicators calculated correctly
   - Test: Status icons assigned correctly (âœ“, âš ï¸, âŒ)

**Deliverable:** Factory Comparison Report with export options

---

### Day 4: Trend Analysis Report

**Duration:** 8 hours
**Developer:** Senior Developer B

**Tasks:**

1. **Create TrendAnalysis action** (2 hours)
   - Create `ReportsController.TrendAnalysis()` action
   - Add filters: factory, metric, date range, granularity
   - Query time series data based on granularity (daily, weekly, monthly)
   - Generate auto-insights (trend up/down, threshold breach)
   - Return TrendAnalysisViewModel

2. **Implement insight generation** (2 hours)
   - Create `InsightGeneratorService.cs`
   - Implement rules:
     - Detect stability (variance < 5%)
     - Detect significant increase (>10% in last quarter)
     - Detect significant decrease (>10% in last quarter)
     - Detect threshold breach (<90%)
     - Generate recommendations based on trends
   - Return list of insights with icons (âœ“, âš ï¸, ğŸ“Š, ğŸ’¡)

3. **Create TrendAnalysisView** (2 hours)
   - Create `Views/Reports/TrendAnalysis.cshtml`
   - Add filter panel (factory, metric, date range, granularity)
   - Render line chart (Chart.js) with multiple data series
   - Display insights panel below chart
   - Display data table below insights

4. **Add export options** (1 hour)
   - Export chart as PNG: Use Chart.js `toBase64Image()` method
   - Export data as Excel: Include monthly data table
   - Export full report as PDF: Include chart (as image) + insights + data table

5. **Add unit tests** (1 hour)
   - Test: Trend data aggregated correctly for monthly granularity
   - Test: Insights generated correctly for stable trend
   - Test: Insights generated correctly for declining trend

**Deliverable:** Trend Analysis Report with auto-insights

---

### Day 5: Export & Performance Optimization

**Duration:** 8 hours
**Developers:** Senior Developer A + B

**Tasks:**

**Senior Developer A (4 hours):**

1. **Implement Excel export service** (2 hours)
   - Create `Services/ExcelExportService.cs` using EPPlus library
   - Implement methods:
     - ExportDashboard(data)
     - ExportFactoryComparison(data)
     - ExportTrendAnalysis(data)
     - ExportHardwareInventory(data)
   - Format cells (bold headers, borders, colors)
   - Add auto-filter and freeze panes

2. **Implement PDF export service** (2 hours)
   - Create `Services/PdfExportService.cs` using SelectPdf or DinkToPdf
   - Implement methods:
     - ExportDashboardAsPdf(viewModel)
     - ExportReportAsPdf(viewModel, chartImages)
   - Include KTDA branding (logo, header, footer)
   - Render charts as images (convert canvas to PNG)
   - Style with CSS for print media

**Senior Developer B (4 hours):**

3. **Implement caching for performance** (2 hours)
   - Add distributed cache (Redis or Memory Cache)
   - Cache aggregated metrics (5 minutes TTL)
   - Cache historical trend data (10 minutes TTL)
   - Add cache invalidation on new submission approval

4. **Optimize database queries** (2 hours)
   - Add indexes on frequently queried columns:
     - ChecklistSubmissions: TenantId, Status, SubmittedDate
     - ChecklistResponses: SubmissionId, ItemCode
     - TenantHardware: TenantId, Status
     - TenantSoftware: HardwareItemId, SoftwareName
   - Use compiled queries (EF Core)
   - Implement pagination for large result sets

**Both Developers (4 hours):**

5. **Integration testing** (2 hours)
   - Test full dashboard load with 100 factories
   - Test factory comparison with 20 factories
   - Test trend analysis with 12 months data
   - Test export to Excel (verify data integrity)
   - Test export to PDF (verify charts render correctly)

6. **Performance testing** (1 hour)
   - Dashboard loads in < 2 seconds
   - Factory comparison loads in < 3 seconds
   - Trend analysis loads in < 3 seconds
   - Excel export completes in < 5 seconds
   - PDF export completes in < 10 seconds

7. **Bug fixes & polish** (1 hour)
   - Fix any issues found during testing
   - Improve chart responsiveness
   - Add loading spinners for slow operations
   - Add error handling for failed exports

**Deliverable:** Complete Reports & Dashboard module with export functionality

---

## 9. EXPORT FUNCTIONALITY

### 9.1 Export to Excel (XLSX)

**Library:** EPPlus (MIT license)

**Implementation Pattern:**
```csharp
// Pseudo-code for Excel export
public class ExcelExportService
{
    public byte[] ExportFactoryComparison(FactoryComparisonViewModel model)
    {
        using (var package = new ExcelPackage())
        {
            // Add worksheet
            var worksheet = package.Workbook.Worksheets.Add("Factory Comparison");

            // Add header
            worksheet.Cells[1, 1].Value = "KTDA ICT Reporting System";
            worksheet.Cells[2, 1].Value = "Factory Comparison Report";
            worksheet.Cells[3, 1].Value = $"Period: {model.Period}";
            worksheet.Cells[1, 1, 3, 5].Merge = true;
            worksheet.Cells[1, 1].Style.Font.Bold = true;
            worksheet.Cells[1, 1].Style.Font.Size = 16;

            // Add hardware metrics table
            int row = 5;
            worksheet.Cells[row, 1].Value = "Factory";
            worksheet.Cells[row, 2].Value = "Total";
            worksheet.Cells[row, 3].Value = "Operational";
            worksheet.Cells[row, 4].Value = "Faulty";
            worksheet.Cells[row, 5].Value = "Operational %";
            worksheet.Cells[row, 1, row, 5].Style.Font.Bold = true;

            row++;
            foreach (var factory in model.Factories)
            {
                worksheet.Cells[row, 1].Value = factory.Name;
                worksheet.Cells[row, 2].Value = factory.TotalComputers;
                worksheet.Cells[row, 3].Value = factory.Operational;
                worksheet.Cells[row, 4].Value = factory.Faulty;
                worksheet.Cells[row, 5].Value = factory.OperationalPercentage;
                worksheet.Cells[row, 5].Style.Numberformat.Format = "0.0%";

                // Color code based on percentage
                if (factory.OperationalPercentage >= 0.9)
                    worksheet.Cells[row, 5].Style.Fill.SetBackground(Color.LightGreen);
                else if (factory.OperationalPercentage >= 0.8)
                    worksheet.Cells[row, 5].Style.Fill.SetBackground(Color.Yellow);
                else
                    worksheet.Cells[row, 5].Style.Fill.SetBackground(Color.LightCoral);

                row++;
            }

            // Auto-fit columns
            worksheet.Cells.AutoFitColumns();

            // Add borders
            worksheet.Cells[5, 1, row - 1, 5].Style.Border.Top.Style = ExcelBorderStyle.Thin;
            worksheet.Cells[5, 1, row - 1, 5].Style.Border.Bottom.Style = ExcelBorderStyle.Thin;
            worksheet.Cells[5, 1, row - 1, 5].Style.Border.Left.Style = ExcelBorderStyle.Thin;
            worksheet.Cells[5, 1, row - 1, 5].Style.Border.Right.Style = ExcelBorderStyle.Thin;

            // Return as byte array
            return package.GetAsByteArray();
        }
    }
}
```

**Controller Action:**
```csharp
// Pseudo-code for Excel download
[HttpGet]
public IActionResult ExportToExcel()
{
    var model = GetFactoryComparisonData();
    var excelBytes = _excelExportService.ExportFactoryComparison(model);

    return File(
        excelBytes,
        "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
        $"Factory_Comparison_{DateTime.Now:yyyyMMdd}.xlsx"
    );
}
```

**Features:**
- Bold headers with larger font
- Color-coded cells based on thresholds
- Auto-fit columns for readability
- Borders around tables
- Multiple worksheets for different sections
- Number formatting (percentages, decimals)

---

### 9.2 Export to PDF

**Library:** SelectPdf or DinkToPdf

**Implementation Pattern:**
```csharp
// Pseudo-code for PDF export
public class PdfExportService
{
    public byte[] ExportReportAsPdf(string htmlContent, List<string> chartImageUrls)
    {
        // Convert Chart.js charts to images first (client-side)
        // Pass base64 image strings or URLs to this method

        var converter = new HtmlToPdf();

        // Configure PDF settings
        converter.Options.PdfPageSize = PdfPageSize.A4;
        converter.Options.PdfPageOrientation = PdfPageOrientation.Portrait;
        converter.Options.MarginTop = 20;
        converter.Options.MarginBottom = 20;
        converter.Options.MarginLeft = 15;
        converter.Options.MarginRight = 15;

        // Add header
        converter.Options.DisplayHeader = true;
        converter.Header.DisplayOnFirstPage = true;
        converter.Header.Height = 50;
        var headerHtml = @"
            <div style='text-align: center; font-family: Arial; padding: 10px;'>
                <img src='logo.png' height='30' />
                <h3>KTDA ICT Reporting System</h3>
            </div>
        ";
        converter.Header.Add(headerHtml);

        // Add footer
        converter.Options.DisplayFooter = true;
        converter.Footer.DisplayOnFirstPage = true;
        converter.Footer.Height = 30;
        var footerHtml = @"
            <div style='text-align: center; font-family: Arial; font-size: 10px;'>
                Page {page_number} of {total_pages} | Generated on {date}
            </div>
        ";
        converter.Footer.Add(footerHtml);

        // Convert HTML to PDF
        var pdfDocument = converter.ConvertHtmlString(htmlContent);

        // Return as byte array
        return pdfDocument.Save();
    }
}
```

**HTML Template for PDF:**
```html
<!-- Pseudo-HTML for PDF report -->
<!DOCTYPE html>
<html>
<head>
    <style>
        body { font-family: Arial, sans-serif; }
        h1 { color: #2c5f2d; text-align: center; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #2c5f2d; color: white; }
        .metric-card { border: 1px solid #ddd; padding: 15px; margin: 10px 0; }
        .chart { text-align: center; margin: 20px 0; }
    </style>
</head>
<body>
    <h1>Factory Comparison Report</h1>
    <p><strong>Period:</strong> October 2025</p>
    <p><strong>Region:</strong> Nairobi</p>

    <div class="chart">
        <h3>Operational Status Comparison</h3>
        <img src="@Model.ChartImageBase64" width="600" />
    </div>

    <h2>Hardware Metrics</h2>
    <table>
        <thead>
            <tr>
                <th>Factory</th>
                <th>Total</th>
                <th>Operational</th>
                <th>Faulty</th>
                <th>OP %</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var factory in Model.Factories)
            {
                <tr>
                    <td>@factory.Name</td>
                    <td>@factory.Total</td>
                    <td>@factory.Operational</td>
                    <td>@factory.Faulty</td>
                    <td>@factory.OperationalPercentage%</td>
                    <td>@factory.StatusIcon</td>
                </tr>
            }
        </tbody>
    </table>
</body>
</html>
```

**Chart to Image Conversion (Client-side JavaScript):**
```javascript
// Pseudo-code for converting Chart.js to image
function exportChartAsImage(chartId) {
    var canvas = document.getElementById(chartId);
    var imageUrl = canvas.toDataURL('image/png');

    // Send to server via hidden input
    document.getElementById('chartImageInput').value = imageUrl;
}

// Call before submitting export form
$('#exportPdfBtn').click(function() {
    exportChartAsImage('trendChart');
    $('#exportForm').submit();
});
```

---

### 9.3 Email Report

**Implementation:**
```csharp
// Pseudo-code for emailing report
public class ReportEmailService
{
    public async Task EmailReport(int reportId, List<string> recipientEmails)
    {
        // Generate PDF
        var pdfBytes = _pdfExportService.ExportReportAsPdf(reportId);

        // Create email
        var email = new EmailMessage
        {
            To = recipientEmails,
            Subject = $"Factory Comparison Report - {DateTime.Now:MMMM yyyy}",
            Body = @"
                Dear Team,

                Please find attached the Factory Comparison Report for the current period.

                Key Highlights:
                - Overall operational percentage: 90%
                - 3 factories below 90% threshold
                - Recommendation: Schedule maintenance for Ndima Factory

                Best regards,
                KTDA ICT Reporting System
            ",
            Attachments = new List<EmailAttachment>
            {
                new EmailAttachment
                {
                    FileName = $"Factory_Comparison_{DateTime.Now:yyyyMMdd}.pdf",
                    ContentType = "application/pdf",
                    Content = pdfBytes
                }
            }
        };

        // Send via Hangfire background job
        BackgroundJob.Enqueue(() => _emailService.SendAsync(email));
    }
}
```

---

## 10. PERFORMANCE OPTIMIZATION

### 10.1 Database Query Optimization

**Indexes:**
```sql
-- Add indexes for frequently queried columns
CREATE INDEX IX_Submissions_Tenant_Status_Date
    ON ChecklistSubmissions(TenantId, Status, SubmittedDate);

CREATE INDEX IX_Responses_Submission_ItemCode
    ON ChecklistResponses(SubmissionId, ItemCode);

CREATE INDEX IX_Hardware_Tenant_Status
    ON TenantHardware(TenantId, Status);

CREATE INDEX IX_Software_Hardware_Name
    ON TenantSoftware(HardwareItemId, SoftwareName, LicenseExpiryDate);

CREATE INDEX IX_Tickets_Tenant_Status_Date
    ON SupportTickets(TenantId, Status, CreatedDate);
```

**Compiled Queries (EF Core):**
```csharp
// Pseudo-code for compiled queries
private static readonly Func<ApplicationDbContext, int, DateTime, IEnumerable<SubmissionDto>>
    GetApprovedSubmissions = EF.CompileQuery(
        (ApplicationDbContext context, int tenantId, DateTime fromDate) =>
            context.ChecklistSubmissions
                .Where(s => s.TenantId == tenantId && s.Status == "Approved" && s.SubmittedDate >= fromDate)
                .Select(s => new SubmissionDto { ... })
    );

// Usage
var submissions = GetApprovedSubmissions(dbContext, tenantId, fromDate).ToList();
```

**Benefits:**
- 30-50% faster query execution
- Query plan compiled once, reused multiple times
- Reduced CPU usage on database server

---

### 10.2 Caching Strategy

**Distributed Cache (Redis):**
```csharp
// Pseudo-code for caching
public class CachedReportingService
{
    private readonly IDistributedCache _cache;
    private readonly ReportingService _reportingService;

    public async Task<SummaryMetrics> GetSummaryMetrics(int userId, DateRange dateRange)
    {
        var cacheKey = $"summary_metrics_{userId}_{dateRange.Start:yyyyMMdd}_{dateRange.End:yyyyMMdd}";

        // Try to get from cache
        var cachedValue = await _cache.GetStringAsync(cacheKey);
        if (!string.IsNullOrEmpty(cachedValue))
        {
            return JsonSerializer.Deserialize<SummaryMetrics>(cachedValue);
        }

        // Cache miss - fetch from database
        var metrics = await _reportingService.GetSummaryMetrics(userId, dateRange);

        // Store in cache (5 minutes TTL)
        var cacheOptions = new DistributedCacheEntryOptions
        {
            AbsoluteExpirationRelativeToNow = TimeSpan.FromMinutes(5)
        };
        await _cache.SetStringAsync(cacheKey, JsonSerializer.Serialize(metrics), cacheOptions);

        return metrics;
    }
}
```

**Cache Invalidation:**
```csharp
// Invalidate cache when new submission approved
public async Task OnSubmissionApproved(int submissionId)
{
    var submission = await _db.Submissions.FindAsync(submissionId);

    // Invalidate all related cache keys
    var keysToInvalidate = new[]
    {
        $"summary_metrics_{submission.TenantId}_*",
        $"trend_data_{submission.TenantId}_*",
        "top_factories_*"
    };

    foreach (var keyPattern in keysToInvalidate)
    {
        await _cache.RemoveAsync(keyPattern);
    }
}
```

---

### 10.3 Pagination

**Large Result Sets:**
```csharp
// Pseudo-code for pagination
public async Task<PagedResult<HardwareItemDto>> GetHardwareInventory(
    int tenantId,
    int pageNumber,
    int pageSize)
{
    var query = _db.TenantHardware
        .Where(h => h.TenantId == tenantId && h.Status != "Retired");

    var totalCount = await query.CountAsync();

    var items = await query
        .OrderBy(h => h.HardwareItemId)
        .Skip((pageNumber - 1) * pageSize)
        .Take(pageSize)
        .Select(h => new HardwareItemDto { ... })
        .ToListAsync();

    return new PagedResult<HardwareItemDto>
    {
        Items = items,
        TotalCount = totalCount,
        PageNumber = pageNumber,
        PageSize = pageSize,
        TotalPages = (int)Math.Ceiling(totalCount / (double)pageSize)
    };
}
```

---

### 10.4 Asynchronous Loading

**Partial Views + AJAX:**
```javascript
// Pseudo-code for lazy loading activity feed
$(document).ready(function() {
    // Load dashboard immediately (summary cards only)
    // Activity feed loads asynchronously

    setTimeout(function() {
        $.get('/Dashboard/GetActivityFeed', function(html) {
            $('#activityFeed').html(html);
        });
    }, 500);
});
```

---

## 11. TESTING CHECKLIST

### 11.1 Unit Tests

**Dashboard Tests:**
- [ ] `GetSummaryMetrics_ReturnsCorrectCounts`
- [ ] `GetSummaryMetrics_FiltersBy UserAuthority`
- [ ] `GetSummaryMetrics_FiltersBy DateRange`
- [ ] `GetTrendData_ReturnsCorrectMonthlyData`
- [ ] `GetTopFactories_ReturnsTop5`

**Report Tests:**
- [ ] `FactoryComparison_CalculatesOperationalPercentage`
- [ ] `FactoryComparison_CalculatesChangeIndicators`
- [ ] `TrendAnalysis_AggregatesDataByMonth`
- [ ] `TrendAnalysis_GeneratesInsights`

**Export Tests:**
- [ ] `ExportToExcel_GeneratesValidXlsxFile`
- [ ] `ExportToPdf_GeneratesValidPdfFile`
- [ ] `ExportToPdf_IncludesCharts`

---

### 11.2 Integration Tests

**Dashboard Tests:**
- [ ] Dashboard loads with real data from database
- [ ] Filter by date range updates dashboard correctly
- [ ] Trend chart displays correct data points
- [ ] Top factories chart displays correct rankings

**Report Tests:**
- [ ] Factory comparison shows correct metrics for all factories
- [ ] Trend analysis shows correct time series data
- [ ] Hardware inventory report shows all hardware items
- [ ] Software license report shows compliance percentages

**Export Tests:**
- [ ] Excel export downloads with correct filename
- [ ] PDF export includes charts as images
- [ ] Email report sends successfully with attachment

---

### 11.3 UI/UX Tests

**Dashboard:**
- [ ] Summary cards display correctly
- [ ] Trend chart renders without errors
- [ ] Top factories chart renders without errors
- [ ] Activity feed displays recent events
- [ ] Responsive layout works on mobile/tablet/desktop

**Reports:**
- [ ] Factory comparison tables sortable by column
- [ ] Trend analysis chart interactive (hover shows values)
- [ ] Hardware inventory table paginated correctly
- [ ] License compliance shows expiry warnings

**Charts:**
- [ ] Line chart smooth curves render correctly
- [ ] Bar chart colors match thresholds (green/yellow/red)
- [ ] Pie chart legend displays on right
- [ ] Charts resize on window resize

---

### 11.4 Performance Tests

**Load Testing:**
- [ ] Dashboard loads < 2 seconds with 100 factories
- [ ] Factory comparison loads < 3 seconds with 20 factories
- [ ] Trend analysis loads < 3 seconds with 12 months data
- [ ] Hardware inventory loads < 2 seconds with 1000+ items

**Export Performance:**
- [ ] Excel export completes < 5 seconds for 100 rows
- [ ] PDF export completes < 10 seconds with 3 charts
- [ ] Email sends < 3 seconds (background job queued)

**Stress Testing:**
- [ ] 50 concurrent dashboard loads without errors
- [ ] 20 concurrent PDF exports without timeout
- [ ] Cache handles concurrent requests correctly

---

### 11.5 Security Tests

**Authorization:**
- [ ] Factory user cannot see other factories' data
- [ ] Regional manager cannot see other regions' data
- [ ] Head Office can see all data
- [ ] Unauthorized access returns 403 Forbidden

**Data Validation:**
- [ ] SQL injection attempts blocked in filters
- [ ] XSS attempts sanitized in exports
- [ ] Invalid date ranges return error messages

---

### 11.6 Accessibility Tests

**WCAG 2.1 Compliance:**
- [ ] Charts have text alternatives (data tables below)
- [ ] Color-coded metrics also use icons (not color only)
- [ ] Keyboard navigation works (Tab through filters)
- [ ] Screen reader announces chart data
- [ ] Focus indicators visible

---

## DOCUMENT END

**Next Steps:**
1. Review this document with development team
2. Clarify any questions or ambiguities
3. Begin Day 1 implementation (Executive Dashboard backend)
4. Follow step-by-step guide through Day 5
5. Conduct thorough testing using checklist in Section 11
6. Deploy to staging environment for UAT
7. Gather feedback and make refinements
8. Deploy to production

**Related Documents:**
- [0_ChecklistSystem_Overview.md](0_ChecklistSystem_Overview.md) - System overview
- [1_Automation_Points.md](1_Automation_Points.md) - Pre-fill opportunities
- [2_ImplementationPlan.md](2_ImplementationPlan.md) - Master implementation plan
- [3_FormBuilder_Implementation.md](3_FormBuilder_Implementation.md) - Template builder
- [4_FormRendering_Implementation.md](4_FormRendering_Implementation.md) - Form rendering
- [5_ApprovalWorkflow_Implementation.md](5_ApprovalWorkflow_Implementation.md) - Approval workflow

**Questions or Clarifications:**
Contact: ICT Development Team Lead