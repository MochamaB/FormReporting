@model FormReporting.Models.ViewModels.Components.FormFieldViewModel

@*
    DateTime Field - Date and time picker input
*@

<div class="mb-3 col-md-@Model.ColumnWidth">
    <label for="@Model.InputId" class="form-label" style="word-wrap: break-word; overflow-wrap: break-word;">
        @if (Model.ShowFieldNumber)
        {
            <span class="text-primary me-2">@Model.DisplayOrder.</span>
        }
        @Model.FieldName
        @if (Model.IsRequired)
        {
            <span class="text-danger">*</span>
        }
    </label>

    @{
        // For datetime-local, combine date and time for min/max
        var minDateTime = !string.IsNullOrEmpty(Model.MinDate) ? Model.MinDate : "";
        var maxDateTime = !string.IsNullOrEmpty(Model.MaxDate) ? Model.MaxDate : "";
        
        // Append time if available
        if (!string.IsNullOrEmpty(minDateTime) && !string.IsNullOrEmpty(Model.MinTime))
        {
            minDateTime += "T" + Model.MinTime;
        }
        else if (!string.IsNullOrEmpty(minDateTime))
        {
            minDateTime += "T00:00";
        }
        
        if (!string.IsNullOrEmpty(maxDateTime) && !string.IsNullOrEmpty(Model.MaxTime))
        {
            maxDateTime += "T" + Model.MaxTime;
        }
        else if (!string.IsNullOrEmpty(maxDateTime))
        {
            maxDateTime += "T23:59";
        }
    }
    <input type="datetime-local"
           class="form-control"
           id="@Model.InputId"
           name="@Model.InputName"
           value="@Model.CurrentValue"
           @(Model.IsRequired ? "required" : "")
           @(Model.IsReadOnly ? "readonly" : "")
           @(Model.IsDisabled ? "disabled" : "")
           @if (!string.IsNullOrEmpty(minDateTime))
           {
               <text>min="@minDateTime"</text>
           }
           @if (!string.IsNullOrEmpty(maxDateTime))
           {
               <text>max="@maxDateTime"</text>
           }
           data-field-id="@Model.FieldId"
           @if (!string.IsNullOrEmpty(Model.ValidationDataAttribute))
           {
               <text>data-validation='@Model.ValidationDataAttribute'</text>
           }
           @if (!string.IsNullOrEmpty(Model.ConditionalLogicDataAttribute))
           {
               <text>data-conditional='@Model.ConditionalLogicDataAttribute'</text>
           } />

    @if (!string.IsNullOrEmpty(Model.HelpText))
    {
        <div class="form-text">@Model.HelpText</div>
    }

    <div class="invalid-feedback"></div>
</div>
