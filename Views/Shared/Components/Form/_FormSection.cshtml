@model FormReporting.Models.ViewModels.Components.FormSectionViewModel

@*
    Form Section - Clean, transparent section with individual field cards
    Industry-standard design: minimal section chrome, each field in its own card
*@

@{
    var collapseClass = Model.IsCollapsedByDefault ? "collapse" : "collapse show";
    var ariaExpanded = Model.IsCollapsedByDefault ? "false" : "true";
}

<div class="form-section-wrapper"
     id="section-card-@Model.SectionId"
     data-section-id="@Model.SectionId">

    @* Section Header - Clean, minimal styling *@
    <div class="form-section-header mb-4">
        <div class="d-flex align-items-start">
            @if (!string.IsNullOrEmpty(Model.IconClass))
            {
                <div class="section-icon-wrapper me-3">
                    <i class="@Model.IconClass"></i>
                </div>
            }
            <div class="flex-grow-1">
                <h4 class="form-section-title mb-1">
                    @Model.SectionName
                    @if (Model.IsRequired)
                    {
                        <span class="text-danger">*</span>
                    }
                </h4>
                @if (!string.IsNullOrEmpty(Model.SectionDescription))
                {
                    <p class="form-section-description text-muted mb-0">@Model.SectionDescription</p>
                }
            </div>
            @if (Model.TotalFields > 0)
            {
                <span class="badge bg-light text-secondary border">
                    @Model.TotalFields @(Model.TotalFields == 1 ? "question" : "questions")
                </span>
            }
        </div>
    </div>

    @* Section Body - Fields Container *@
    <div class="form-section-body">
        <div class="form-fields-container">
            @foreach (var field in Model.Fields)
            {
                @await Html.PartialAsync("Components/Form/_FormField", field)
            }
        </div>
    </div>
</div>

@* Clean Form Section Styles *@
<style>
    /* Section Wrapper - Transparent background */
    .form-section-wrapper {
        margin-bottom: 2rem;
    }

    /* Section Header - Sticky at top */
    .form-section-header {
        position: sticky;
        top: 160px; /* Below the progress header */
        z-index: 100;
        background: #f3f3f9; /* Match wizard wrapper background */
        padding: 0.75rem 0;
        margin: 0 -0.5rem;
        padding-left: 0.5rem;
        padding-right: 0.5rem;
        border-bottom: 2px solid var(--vz-primary);
        margin-bottom: 1.5rem;
    }

    .form-section-title {
        font-size: 1.25rem;
        font-weight: 600;
        color: #495057;
        margin: 0;
    }

    .form-section-description {
        font-size: 0.875rem;
        line-height: 1.5;
    }

    .section-icon-wrapper {
        width: 40px;
        height: 40px;
        background: var(--vz-primary-bg-subtle);
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--vz-primary);
        font-size: 1.25rem;
    }

    /* Fields Container */
    .form-fields-container {
        display: flex;
        flex-direction: column;
        gap: 1rem;
        margin-left: 2.5rem;
    }

    /* Hide scrollbar by default, show on hover */
    .form-wizard-wrapper {
        scrollbar-width: thin;
        scrollbar-color: transparent transparent;
    }

    .form-wizard-wrapper:hover {
        scrollbar-color: rgba(0, 0, 0, 0.2) transparent;
    }

    /* Webkit browsers (Chrome, Safari, Edge) */
    .form-wizard-wrapper::-webkit-scrollbar {
        width: 6px;
    }

    .form-wizard-wrapper::-webkit-scrollbar-track {
        background: transparent;
    }

    .form-wizard-wrapper::-webkit-scrollbar-thumb {
        background-color: transparent;
        border-radius: 3px;
        transition: background-color 0.3s ease;
    }

    .form-wizard-wrapper:hover::-webkit-scrollbar-thumb {
        background-color: rgba(0, 0, 0, 0.2);
    }

    /* Global page scrollbar - hide unless hovering on content area */
    body {
        scrollbar-width: thin;
        scrollbar-color: transparent transparent;
    }

    body:hover {
        scrollbar-color: rgba(0, 0, 0, 0.2) transparent;
    }

    body::-webkit-scrollbar {
        width: 8px;
    }

    body::-webkit-scrollbar-track {
        background: transparent;
    }

    body::-webkit-scrollbar-thumb {
        background-color: transparent;
        border-radius: 4px;
    }

    body:hover::-webkit-scrollbar-thumb {
        background-color: rgba(0, 0, 0, 0.2);
    }
</style>
