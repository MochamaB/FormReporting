@model FormReporting.Models.ViewModels.Components.FormViewModel

@{
    ViewData["Title"] = "Form Field Types Showcase";
    ViewData["Breadcrumbs"] = new List<(string Title, string? Url)>
    {
        ("Component Tests", "/ComponentTest"),
        ("Field Types Showcase", null)
    };
}

<style>
    /* Showcase-specific styling */
    .showcase-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 2rem;
        border-radius: 8px;
        margin-bottom: 2rem;
    }

    .showcase-stats {
        display: flex;
        gap: 2rem;
        justify-content: center;
        flex-wrap: wrap;
        margin-top: 1rem;
    }

    .showcase-stat {
        text-align: center;
    }

    .showcase-stat-number {
        font-size: 2rem;
        font-weight: 700;
        display: block;
    }

    .showcase-stat-label {
        font-size: 0.875rem;
        opacity: 0.9;
    }

    .field-type-badge {
        position: absolute;
        top: 0.5rem;
        right: 0.5rem;
        font-size: 0.75rem;
        padding: 0.25rem 0.5rem;
        background: #f3f6f9;
        color: #6c757d;
        border-radius: 4px;
        font-family: 'Courier New', monospace;
    }

    .card-header {
        position: relative;
    }
</style>

@* Showcase Header *@
<div class="showcase-header">
    <div class="text-center">
        <h1 class="mb-3">
            <i class="ri-palette-line me-2"></i>
            Form Field Types Showcase
        </h1>
        <p class="mb-0" style="font-size: 1.125rem;">
            Complete demonstration of all 21 available form field types
        </p>
        <div class="showcase-stats">
            <div class="showcase-stat">
                <span class="showcase-stat-number">21</span>
                <span class="showcase-stat-label">Field Types</span>
            </div>
            <div class="showcase-stat">
                <span class="showcase-stat-number">7</span>
                <span class="showcase-stat-label">Categories</span>
            </div>
            <div class="showcase-stat">
                <span class="showcase-stat-number">@Model.Sections.Count</span>
                <span class="showcase-stat-label">Sections</span>
            </div>
        </div>
    </div>
</div>

@* Navigation Quick Links *@
<div class="card mb-4">
    <div class="card-body">
        <h6 class="mb-3">
            <i class="ri-links-line me-2"></i>
            Quick Navigation
        </h6>
        <div class="d-flex flex-wrap gap-2">
            @foreach (var section in Model.Sections.OrderBy(s => s.DisplayOrder))
            {
                <a href="#section-@(section.SectionId)" class="btn btn-sm btn-outline-primary">
                    <i class="@(section.IconClass) me-1"></i>
                    @(section.SectionName)
                </a>
            }
        </div>
    </div>
</div>

@* Field Type Categories Info *@
<div class="alert alert-info mb-4" role="alert">
    <h6 class="alert-heading">
        <i class="ri-information-line me-2"></i>
        About Field Types
    </h6>
    <p class="mb-0">
        This showcase demonstrates all available form field types grouped by category.
        Each field includes examples with help text, validation, and formatting options.
        Try interacting with each field to see how it behaves!
    </p>
</div>

@* Render the form *@
<div class="row">
    <div class="col-12">
        @await Html.PartialAsync("Components/Form/_Form", Model)
    </div>
</div>

@* Field Type Reference Table *@
<div class="card mt-4">
    <div class="card-header">
        <h5 class="mb-0">
            <i class="ri-file-list-3-line me-2"></i>
            Field Type Reference
        </h5>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>Category</th>
                        <th>Field Type</th>
                        <th>Enum Value</th>
                        <th>Use Case</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td rowspan="4" class="align-middle"><strong>Input</strong></td><td>Text</td><td><code>FormFieldType.Text</code></td><td>Single-line text input</td></tr>
                    <tr><td>TextArea</td><td><code>FormFieldType.TextArea</code></td><td>Multi-line text input</td></tr>
                    <tr><td>Number</td><td><code>FormFieldType.Number</code></td><td>Integer numbers</td></tr>
                    <tr><td>Decimal</td><td><code>FormFieldType.Decimal</code></td><td>Decimal numbers with precision</td></tr>

                    <tr><td rowspan="3" class="align-middle"><strong>Date/Time</strong></td><td>Date</td><td><code>FormFieldType.Date</code></td><td>Date selection</td></tr>
                    <tr><td>Time</td><td><code>FormFieldType.Time</code></td><td>Time selection (hours/minutes)</td></tr>
                    <tr><td>DateTime</td><td><code>FormFieldType.DateTime</code></td><td>Date and time combined</td></tr>

                    <tr><td rowspan="4" class="align-middle"><strong>Selection</strong></td><td>Dropdown</td><td><code>FormFieldType.Dropdown</code></td><td>Single selection from list</td></tr>
                    <tr><td>Radio</td><td><code>FormFieldType.Radio</code></td><td>Single selection with radio buttons</td></tr>
                    <tr><td>Checkbox</td><td><code>FormFieldType.Checkbox</code></td><td>Multiple selections</td></tr>
                    <tr><td>MultiSelect</td><td><code>FormFieldType.MultiSelect</code></td><td>Multiple selections from dropdown</td></tr>

                    <tr><td rowspan="3" class="align-middle"><strong>Media</strong></td><td>FileUpload</td><td><code>FormFieldType.FileUpload</code></td><td>File attachment</td></tr>
                    <tr><td>Image</td><td><code>FormFieldType.Image</code></td><td>Image upload with preview</td></tr>
                    <tr><td>Signature</td><td><code>FormFieldType.Signature</code></td><td>Canvas-based signature capture</td></tr>

                    <tr><td rowspan="2" class="align-middle"><strong>Rating</strong></td><td>Rating</td><td><code>FormFieldType.Rating</code></td><td>Star ratings (1-5)</td></tr>
                    <tr><td>Slider</td><td><code>FormFieldType.Slider</code></td><td>Range slider input</td></tr>

                    <tr><td rowspan="3" class="align-middle"><strong>Contact</strong></td><td>Email</td><td><code>FormFieldType.Email</code></td><td>Email with validation</td></tr>
                    <tr><td>Phone</td><td><code>FormFieldType.Phone</code></td><td>Phone number input</td></tr>
                    <tr><td>Url</td><td><code>FormFieldType.Url</code></td><td>URL with validation</td></tr>

                    <tr><td rowspan="2" class="align-middle"><strong>Specialized</strong></td><td>Currency</td><td><code>FormFieldType.Currency</code></td><td>Money amounts with prefix</td></tr>
                    <tr><td>Percentage</td><td><code>FormFieldType.Percentage</code></td><td>Percentage values (0-100)</td></tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

@* Usage Instructions *@
<div class="card mt-4 mb-4">
    <div class="card-header bg-success text-white">
        <h5 class="mb-0">
            <i class="ri-code-box-line me-2"></i>
            How to Use in Your Code
        </h5>
    </div>
    <div class="card-body">
        <h6>Example: Creating a form with different field types</h6>
        <pre class="bg-light p-3 rounded"><code>var formConfig = new FormConfig
{
    FormId = "my_form",
    Title = "My Form"
};

formConfig.WithSection("Section Name", "Description", section =>
{
    // Text field
    section.WithTextField("field1", "Field Name", isRequired: true);

    // Dropdown
    section.WithDropdownField("field2", "Select Option", new List&lt;FormFieldOption&gt;
    {
        new FormFieldOption { Value = "opt1", Label = "Option 1" }
    });

    // Date field
    section.WithDateField("field3", "Date", isRequired: true);

    // Custom field type
    var customField = new FormFieldConfig
    {
        FieldId = "field4",
        FieldName = "Custom Field",
        FieldType = FormFieldType.Rating
    };
    section.WithField(customField);
});

var viewModel = formConfig.BuildForm();
return View(viewModel);</code></pre>
    </div>
</div>

@section Scripts
{
    <script>
        // Form submission handler
        document.getElementById('form-@Model.FormId')?.addEventListener('submit', function(e) {
            e.preventDefault();

            // Collect form data
            var formData = new FormData(this);
            var data = {};
            formData.forEach((value, key) => {
                if (data[key]) {
                    if (Array.isArray(data[key])) {
                        data[key].push(value);
                    } else {
                        data[key] = [data[key], value];
                    }
                } else {
                    data[key] = value;
                }
            });

            console.log('Form Data:', data);

            // Show success message with data
            var dataJson = JSON.stringify(data, null, 2);
            alert('Form submitted successfully! (Test mode)\n\nSubmitted data logged to console.\n\nSee browser console (F12) for full data.');
        });

        // Reset form handler
        window.resetForm = function(formId) {
            if (confirm('Are you sure you want to reset this form? All changes will be lost.')) {
                var form = document.getElementById('form-' + formId);
                if (form) {
                    form.reset();
                    // Clear signature canvases
                    document.querySelectorAll('.signature-canvas').forEach(canvas => {
                        var ctx = canvas.getContext('2d');
                        ctx.clearRect(0, 0, canvas.width, canvas.height);
                    });
                    // Clear image previews
                    document.querySelectorAll('[id$="_preview"]').forEach(preview => {
                        preview.innerHTML = '';
                    });
                }
            }
        };

        // Smooth scroll for quick navigation
        document.querySelectorAll('a[href^="#section-"]').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                var targetId = this.getAttribute('href').substring(1);
                var target = document.getElementById(targetId);
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });
    </script>
}
